{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/trong/Desktop/Chat App using React and Firebase/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/trong/Desktop/Chat App using React and Firebase/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\trong\\\\Desktop\\\\Chat App using React and Firebase\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from\"react\";import Add from\"../img/addAvatar.png\";import{createUserWithEmailAndPassword,updateProfile}from\"firebase/auth\";import{auth,db,storage}from\"../firebase\";import{useState}from\"react\";import{ref,uploadBytesResumable,getDownloadURL}from\"firebase/storage\";import{doc,setDoc}from\"firebase/firestore\";import{Link,useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Register=function Register(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),err=_useState2[0],setErr=_useState2[1];var navigate=useNavigate();var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var displayName,email,password,file,res,storageRef,uploadTask;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();displayName=e.target[0].value;email=e.target[1].value;password=e.target[2].value;file=e.target[3].files[0];_context2.prev=5;_context2.next=8;return createUserWithEmailAndPassword(auth,email,password);case 8:res=_context2.sent;storageRef=ref(storage,displayName);uploadTask=uploadBytesResumable(storageRef,file);uploadTask.on(function(error){setErr(true);},function(){getDownloadURL(uploadTask.snapshot.ref).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(downloadURL){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return updateProfile(res.user,{displayName:displayName,photoURL:downloadURL});case 2:_context.next=4;return setDoc(doc(db,\"users\",res.user.uid),{uid:res.user.uid,displayName:displayName,email:email,photoURL:downloadURL});case 4:_context.next=6;return setDoc(doc(db,\"userChats\",res.user.uid),{});case 6:navigate(\"/\");case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref2.apply(this,arguments);};}());});_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](5);setErr(true);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[5,14]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"formContainer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"formWapper\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"logo\",children:\"Dev 03 - Mr.T \\u2764\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:\"\\u0110\\u0103ng k\\xED\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"T\\xEAn\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"M\\u1EADt kh\\u1EA9u\"}),/*#__PURE__*/_jsx(\"input\",{style:{display:\"none\"},type:\"file\",id:\"file\"}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"file\",children:[/*#__PURE__*/_jsx(\"img\",{src:Add,alt:\"\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Th\\xEAm \\u1EA3nh \\u0111\\u1EA1i di\\u1EC7n\"})]}),/*#__PURE__*/_jsx(\"button\",{children:\"\\u0110\\u0103ng k\\xED\"}),err&&/*#__PURE__*/_jsx(\"span\",{children:\"\\u0110\\xE3 s\\u1EA3y ra s\\u1EF1 c\\u1ED1\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"B\\u1EA1n \\u0111\\xE3 c\\xF3 t\\xE0i kho\\u1EA3n? \",/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"\\u0110\\u0103ng nh\\u1EADp\"})]})]})});};export default Register;","map":{"version":3,"sources":["C:/Users/trong/Desktop/Chat App using React and Firebase/src/pages/Register.jsx"],"names":["React","Add","createUserWithEmailAndPassword","updateProfile","auth","db","storage","useState","ref","uploadBytesResumable","getDownloadURL","doc","setDoc","Link","useNavigate","Register","err","setErr","navigate","handleSubmit","e","preventDefault","displayName","target","value","email","password","file","files","res","storageRef","uploadTask","on","error","snapshot","then","downloadURL","user","photoURL","uid","display"],"mappings":"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","sourcesContent":["\r\nimport React from \"react\";\r\nimport Add from \"../img/addAvatar.png\";\r\nimport { createUserWithEmailAndPassword, updateProfile } from \"firebase/auth\";\r\nimport { auth, db, storage } from \"../firebase\";\r\nimport { useState } from \"react\";\r\nimport { ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\r\nimport { doc, setDoc } from \"firebase/firestore\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\n\r\nconst Register = () => {\r\n  const [err, setErr] = useState(false);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const displayName = e.target[0].value;\r\n    const email = e.target[1].value;\r\n    const password = e.target[2].value;\r\n    const file = e.target[3].files[0];\r\n\r\n    try {\r\n      const res = await createUserWithEmailAndPassword(auth, email, password);\r\n\r\n      const storageRef = ref(storage, displayName);\r\n\r\n      const uploadTask = uploadBytesResumable(storageRef, file);\r\n\r\n      uploadTask.on(\r\n        (error) => {\r\n          setErr(true);\r\n        },\r\n        () => {\r\n          getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\r\n            await updateProfile(res.user, {\r\n              displayName,\r\n              photoURL: downloadURL,\r\n            });\r\n            // eslint-disable-next-line no-undef\r\n            await setDoc(doc(db, \"users\", res.user.uid), {\r\n              uid: res.user.uid,\r\n              displayName,\r\n              email,\r\n              photoURL: downloadURL,\r\n            });\r\n\r\n            // eslint-disable-next-line no-undef\r\n            await setDoc(doc(db, \"userChats\", res.user.uid), {});\r\n\r\n            navigate(\"/\");\r\n          });\r\n        }\r\n      );\r\n    } catch (err) {\r\n      setErr(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"formContainer\">\r\n      <div className=\"formWapper\">\r\n        <span className=\"logo\">Dev 03 - Mr.T ❤️</span>\r\n        <span className=\"title\">Đăng kí</span>\r\n        <form onSubmit={handleSubmit}>\r\n          <input type=\"text\" placeholder=\"Tên\" />\r\n          <input type=\"email\" placeholder=\"Email\" />\r\n          <input type=\"password\" placeholder=\"Mật khẩu\" />\r\n          <input style={{ display: \"none\" }} type=\"file\" id=\"file\" />\r\n          <label htmlFor=\"file\">\r\n            <img src={Add} alt=\"\"/>\r\n            <span>Thêm ảnh đại diện</span>\r\n          </label>\r\n          <button>Đăng kí</button>\r\n          {err && <span>Đã sảy ra sự cố</span>}\r\n        </form>\r\n        <p>\r\n          Bạn đã có tài khoản? <Link to=\"/login\">Đăng nhập</Link>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n"]},"metadata":{},"sourceType":"module"}